I found the gist of this in a gist at https://gist.github.com/RoryQ/5de8b9c606b423d62343f69ffa059f6f.
